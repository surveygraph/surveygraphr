<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Data cleaning • surveygraph</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data cleaning">
<meta name="description" content="To understand how surveygraph handles irregular data...
">
<meta property="og:description" content="To understand how surveygraph handles irregular data...
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">surveygraph</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/surveygraph.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/datacleaning.html">Data cleaning</a></li>
    <li><a class="dropdown-item" href="../articles/projections.html">Data projections</a></li>
    <li><a class="dropdown-item" href="../articles/syntheticdata.html">Synthetic data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/surveygraph/surveygraphr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Data cleaning</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/surveygraph/surveygraphr/blob/main/vignettes/datacleaning.Rmd" class="external-link"><code>vignettes/datacleaning.Rmd</code></a></small>
      <div class="d-none name"><code>datacleaning.Rmd</code></div>
    </div>

    
    
<p><em>This page is under development. Stay tuned!</em></p>
<p>This vignette gives an overview of how data is preprocessed by the
surveygraph package, following a number of optional arguments that
specify how certain data is to be handled.</p>
<p>We’ll start by loading surveygraph,</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/surveygraph/surveygraphr" class="external-link">surveygraph</a></span><span class="op">)</span></span></code></pre></div>
<p>and assume data <code>S</code> that we attempt to supply to
surveygraph.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    item1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">99</span>, <span class="fl">1</span>,   <span class="fl">1</span>, <span class="fl">100</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">4</span>,  <span class="fl">3</span><span class="op">)</span>,</span>
<span>    item2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,   <span class="fl">3</span>, <span class="fl">1</span>,   <span class="fl">2</span>,   <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>,  <span class="fl">4</span><span class="op">)</span>, </span>
<span>    item3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,   <span class="fl">1</span>, <span class="fl">3</span>, <span class="op">-</span><span class="fl">99</span>,   <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">4</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span></span>
<span><span class="co">#&gt;   item1 item2 item3</span></span>
<span><span class="co">#&gt; 1     2     1     2</span></span>
<span><span class="co">#&gt; 2   -99     3     1</span></span>
<span><span class="co">#&gt; 3     1     1     3</span></span>
<span><span class="co">#&gt; 4     1     2   -99</span></span>
<span><span class="co">#&gt; 5   100     4     5</span></span>
<span><span class="co">#&gt; 6     5     3     6</span></span>
<span><span class="co">#&gt; 7     5     4     8</span></span>
<span><span class="co">#&gt; 8     4     5     4</span></span>
<span><span class="co">#&gt; 9     3     4    10</span></span></code></pre></div>
<div class="section level2">
<h2 id="data-frame-input">Data frame input<a class="anchor" aria-label="anchor" href="#data-frame-input"></a>
</h2>
<p>The first this we check is that the input data <code>S</code> is a
dataframe. If it’s not the program is halted and an error is output.
Future versions may attempt to coerce other formats to dataframes.</p>
<p>For instance, if we attempt to run the <code><a href="../reference/make_projection.html">make_projection()</a></code>
routine on a list, we get the following error.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/make_projection.html">make_projection</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in make_projection(list(c(1, 2, 3))): Input data must be provided as a data frame.</span></span></code></pre></div>
<p>Similarly, an error is output if an empty data frame is provided.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/make_projection.html">make_projection</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in make_projection(data.frame()): Data frame cannot be empty.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="coercion">Coercion<a class="anchor" aria-label="anchor" href="#coercion"></a>
</h2>
<p>Our approach is to coerce all data to floating point types, and to
set them to NA otherwise.</p>
<div class="section level3">
<h3 id="character-strings">Character strings<a class="anchor" aria-label="anchor" href="#character-strings"></a>
</h3>
<p>If columns happen to string literals of numeric data, these are
coerced to floating point numbers, otherwise they are set to
<code>NA</code>.</p>
</div>
<div class="section level3">
<h3 id="logical-values">Logical values<a class="anchor" aria-label="anchor" href="#logical-values"></a>
</h3>
<p>If survey entries contain <code>TRUE</code> or <code>FALSE</code>,
then these are coerced to 1 and 0, respectively.</p>
</div>
</div>
<div class="section level2">
<h2 id="dummy-coding">Dummy coding<a class="anchor" aria-label="anchor" href="#dummy-coding"></a>
</h2>
<p>This is a flag that if set to <code>TRUE</code>, dummy codes
everything that falls outside the range specified by the
<code>likert</code> flag.</p>
</div>
<div class="section level2">
<h2 id="likert-range">Likert range<a class="anchor" aria-label="anchor" href="#likert-range"></a>
</h2>
<p>The <code>likert</code> optional argument allows us to specify the
range of the values that we are to interpret as valid input data. The
idea is that anything that falls outside of this range is set to
<code>NA</code>, or is dummy coded.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    minval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">2</span>, <span class="va">min</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    maxval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">2</span>, <span class="va">max</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This creates the following data frame.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l</span></span>
<span><span class="co">#&gt;       minval maxval</span></span>
<span><span class="co">#&gt; item1    -99    100</span></span>
<span><span class="co">#&gt; item2      1      5</span></span>
<span><span class="co">#&gt; item3    -99     10</span></span></code></pre></div>
<p>The idea is that by visually inspecting the limiting values for each
item, it is obvious which columns contain flags, such as
<code>-99</code> and <code>100</code> in our data. As such, we might
set</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set the minimum value of items one and three to 1</span></span>
<span><span class="va">l</span><span class="op">$</span><span class="va">minval</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">l</span><span class="op">$</span><span class="va">minval</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># set the maximum value of item one to 10</span></span>
<span><span class="va">l</span><span class="op">$</span><span class="va">maxval</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></code></pre></div>
<p>Following these changes, we interpret the Likert ranges to be</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l</span></span>
<span><span class="co">#&gt;       minval maxval</span></span>
<span><span class="co">#&gt; item1      1     10</span></span>
<span><span class="co">#&gt; item2      1      5</span></span>
<span><span class="co">#&gt; item3      1     10</span></span></code></pre></div>
<p>Now, we provide the Likert specification <code>l</code> to
<code>make_projection</code> to tell surveygraph how to handle the
outliers.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># verbose = T</span></span>
<span><span class="co">#make_projection(df, likert=l, showdata=T)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Samuel Unicomb, Ana Jovancevic, Caoimhe O’Reilly, Alejandro Dinkelberg, Pádraig MacCarron, David O’Sullivan, Paul Maher, Mike Quayle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
